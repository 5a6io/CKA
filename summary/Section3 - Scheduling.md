# ğŸ¨ Section3 - Scheduling

## Manual Scheduling


## Practice Test-Manual Scheduling


## Labels and Selectors


## Practice Test-Labels and Selectors


## Taints and Tolerations


## Practice Test-Taints and Tolerations


## Node selectors


## Node Affinity


## Practice Test - Node Affinity


## Test and Tolerations vs Node Affinity


## Resource Requirements and Limits


## A quick note on editing Pods and Deployments


## Practice Test-Resource Requirements and Limits


## DaemonSets


## Practice Test - DaemonSets


## Static Pods


## Practice Test - Static Pods


## Multiple Schedulers


## Practice Test - Multiple Schedulers


## Configuring Scheduler Profiles


## Admission Controllers


NodeRestrictionê³¼ NamespaceAutoProvisionì€ í˜„ì¬ NamsapceLife Cycle Admission Controllerë¡œ ë°”ë€œ.


## Practice Test - Admission Controllers


## Validating and Mutating Admission Controllers


NamespaceExistsë‚˜ NamespaceLifecycle Admission ControllerëŠ” namespaceê°€ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•˜ê³  ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìš”ì²­ì„ ê±°ì ˆí•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤.


DefaultStorageClass plugin


PVC ìƒì„± ìš”ì²­ì„ ë°›ìŒ ì—†ìœ¼ë©´ ìš”ì²­ì„ ìˆ˜ì •í•˜ì—¬ ì¶”ê°€.


PVCë¥¼ ìƒì„±í•˜ê±°ë‚˜ ê´€ì°°í•  ë•Œ, ë¹„ë¡ ìƒì„±í•˜ëŠ” ë™ì•ˆ ëª…ì‹œë˜ì§€ ì•Šì§€ë§Œ StorageClassDefaultëŠ” ê·¸ê²ƒì„ ì¶”ê°€í•œë‹¤.


Mutating Admisison ControllerëŠ” ìƒì„±ë˜ê¸° ì „ì— ê°ì²´ ìì²´ë¥¼ ë°”ê¿€ ìˆ˜ ìˆë‹¤.


Validating Admission ControllerëŠ” ìš”ì²­ì„ í™•ì¸í•˜ê³  ìŠ¹ì¸í•˜ê±°ë‚˜ ê±°ì ˆí•  ìˆ˜ ìˆë‹¤.


ìš”ì²­ì„ í™•ì¸í•  ë¿ë§Œ ì•„ë‹ˆë¼ ë°”ê¿€ ìˆ˜ ìˆëŠ” admission controllerê°€ ìˆì„ ìˆ˜ë„ ìˆë‹¤.


í†µìƒì ìœ¼ë¡œëŠ” Mutating Admission Controllerê°€ ë¨¼ì € ì•¼ê¸°í•˜ê³ , Validating Admission Controllerê°€ ê·¸ ë’¤ë¥¼ ë”°ë¥¸ë‹¤.


NamespaceAutoProvision which is a mutating admission controller, is run first, followed by the validating controller, NamespaceExistsì€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” namespaceì— ëŒ€í•œ ìš”ì²­ì„ ê±°ì ˆí•˜ë‹¤.


NamespaceAutoProvisionì€ ê²°ì½” ì—†ëŠ” namespaceë¥¼ ìƒì„±í•˜ì§€ ì•Šì„ ê²ƒì´ë‹¤.


MutatingAdmissionWebhookê³¼ ValidatingAdmissionWebhook â†’ ì™¸ë¶€ Admission Controller


ìŠ¤ìŠ¤ë¡œ ë¡œì§ì„ ë³€ê²½í•˜ê±°ë‚˜ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ í•  ìˆ˜ ìˆìŒ.

1. admission webhook ì„œë²„ ë°°í¬
2. webhook-serviceë¡œ webhook ì„œë²„ ì ‘ê·¼

mutationwebhookì„ ë°°í¬í•˜ë©´ ê¸°ì¡´ì— ìˆë˜ podê°€ ì‚­ì œë¨.


## Practice Test - Validating and Mutating Admission Controllers

1. NamespaceAutoProvisionì€ Mutating admission controller
NamespaceExistsëŠ” Validating admission controller
2. admissino controllerì˜ ìš”ì²­ íë¦„
mutating â†’ validating
3. webhook-demo namespace ìƒì„±
4. webhook-server-tls ìƒì„±

```shell
kubectl create secret tls webhook-server-tls --cert=/root/keys/webhook-server-tls.yaml --key=/root/keys/webhhok-server-tls.key -n webhook-demo
```

1. ì •ì˜ë˜ì–´ìˆëŠ” webhook-deployment.yamlë¡œ webhook ì„œë²„ ë°°í¬
2. webhook-service.yamlë¡œ ì„œë¹„ìŠ¤ ë°°í¬
3. webhhok-configuration.yamlë¡œ MutatingWebhookConfigurationì„ ì¶”ê°€í•˜ë©´ ë¬´ìŠ¨ ì¼ì´ ë°œìƒí•˜ëŠ”ê°€?
â†’ yaml íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì€ ê·œì¹™ì´ ëª…ì‹œë˜ì–´ìˆìœ¼ë¯€ë¡œ Pod with CREATE operations

```yaml
rules:
  - operations: [ "CREATE" ]
    apiGroups: [""]
    apiVersion: ["v1"]
    resources: ["pods"]
```

1. webhook-configuration.yaml ìƒì„±
2. ì´ì „ ë‹¨ê³„ì—ì„œ ì•„ë˜ì˜ ì¡°ê±´ì„ ê°€ì§„ ë°ëª¨ ì›¹í›…ì„ ë°°í¬í•¨.
- securityContextë¥¼ ì œê³µí•˜ì§€ ì•Šìœ¼ë©´ ì»¨í…Œì´ë„ˆì—ì„œ rootë¡œ ìš´ì˜í•˜ëŠ” ëª¨ë“  íŒŒë“œì— ëŒ€í•œ ìš”ì²­ì„ ê±°ì ˆ.
- runAsNonRootì— ëŒ€í•œ ê°’ì„ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ true, ê·¸ë¦¬ê³  ì‚¬ìš©ì IDëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 1234
- securityContextì—ì„œ runAsNonRootë¥¼ falseë¼ê³  ì •í™•í•˜ê²Œ ëª…ì‹œí•˜ë©´ ë£¨íŠ¸ë¡œ ìš´ì˜í•˜ë„ë¡ í—ˆìš©.
3. pod-with-defaults.yamlë¡œ íŒŒë“œë¥¼ ìƒì„±â†’ securityContextê°€ ì—†ëŠ” íŒŒë“œê°€ ìƒê¹€.
webhook ì—†ë‹¤ë©´ root ìœ ì €ë¡œ ìš´ì˜ë  ê²ƒì´ë‹¤. webhookì€ uid1234ë¥¼ ê°€ì§„ non-root ìœ ì €ë¡œ ìš´ì˜í•˜ê¸° ìœ„í•´ íŒŒë“œë¥¼ ë³€ê²½í•œë‹¤.
4. 10ë²ˆì—ì„œ ìƒì„±í•œ podëŠ” runAsNonRootëŠ” trueì´ë©°, runAsUserëŠ” 1234ì´ë‹¤.
Configurationì— ë”°ë¼ securityContextê°€ ì—†ìœ¼ë¯€ë¡œ runAsNonRootì™€ runAsUserëŠ” ëª¨ë‘ ê¸°ë³¸ê°’ì„ ê°€ì§„ë‹¤.
5. pod-with-override.yamlë¡œ íŒŒë“œ ìƒì„± â†’ ë£¨íŠ¸ ìœ ì €ë¡œ ìš´ì˜ë˜ë„ë¡ í•˜ëŠ” securityContextë¥¼ ê°€ì§„ íŒŒë“œ
webhookì„ ê°–ê³  ê°–ì§€ ì•Šê³  ë°°í¬ì˜ ê²°ê³¼ëŠ” ê°™ìŒ.
ëª…í™•í•˜ê²Œ í•¨ìœ¼ë¡œì¨ Webhookìœ¼ë¡œ ë” ë§ì€ ë³´ì•ˆì´ ì„¤ì •ë˜ëŠ” ê²ƒì„ ë§‰ìŒ.
6. pod-with-conflict.yamlë¡œ íŒŒë“œ ìƒì„± â†’ 
ì„¤ì • ì—†ì´ ë£¨íŠ¸ ìœ ì €ë¡œ ìš´ì˜í•˜ë„ë¡ í•˜ëŠ” ìš”ì²­ì„ ê±°ì ˆí•  ê²ƒ.

![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/b2ea2032-00e9-4883-a13b-cb03cf5b2334/501c3b54-0de4-44d6-afe6-eca0c6373e4f/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=ASIAZI2LB4662SR2HV5Q%2F20250218%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20250218T041322Z&X-Amz-Expires=3600&X-Amz-Security-Token=IQoJb3JpZ2luX2VjEFwaCXVzLXdlc3QtMiJHMEUCIQDWs0i0Xqv5CFkYOh6KD%2FtZxaQaF3BQLpK%2BiPgpGFlNsAIga%2BR5w1QDlcYsFBoStc4Mgox2tOcYTjkPCG5tSGwp0lcqiAQIhf%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2Mzc0MjMxODM4MDUiDGViaYADjXTBaPJPByrcA9zL5JzTaIr5kjmo0IecokGfel9Ob8D1drZLqNn6b9Sa44K%2BHHzvkm%2F1JoZSd9kQsaqAxyySpmh9wzhavozvSre%2FmygMC6pGpwXvCC9HZMGQatKdu27vne%2BPtqp6g67lNKk92kIkCD41YHObpqqNAp8JC0T%2F125jV7biz0a2x4r%2FnBqtUsxwZkWd7FE4Cy96Qy%2BjUlUxwmm7zDFdIZTjBOgf%2FuYYG426zZnxtx9eBhkOsvFmX8F6g%2FH89gRvp2cLVoXPfIClAJZu%2F1D81yGW8dZzMRABDl7RWKNRvfTQJ2BcJGYz6T9uK%2BzTVBGI7XwAbTGacPMg30e0%2BBOP2rXFFp9XGRjVztFsCuIiEcdqk%2FJ0Cho90qeHhoWPfrXBIELEqnPhcWD5vTOn24pPaa0%2F1wPdHY7n3oZFSw8jxiBDWs1kD2kyzo3jIRBfqrwR%2F%2BFH5TaTgsKhbKdCfUta56ntWoNJxCLbK%2Bd1urpt5bxMNJ7RKnPiiVcOR2hL5D%2Fs0di6KS0oOabB3m7OuCWkbkbfRGRdCF%2BH0DaeKWWt%2BDPVpGmcFXNpPs%2FaXmp0C7X3PhPpu581cMkj0GnXUYtU5KLZkFPVV5gewpUsujT6PO1gosjrMojM5Aernk7WYOUSMPaM0L0GOqUB3%2F7VgVcNGy1XlszarVe6Pa6LUU6gGemkB12FwYgvFQLGXC5MGPTNB%2FNaoiTJI8DBQQsMoBZkDs%2B1iv35o%2Fu5mL1Bs408CNNogNSw4mF2K2UOqgddpGUTb%2B4YYaL54MysAzA4mZkaH36d1Ym9i1uvhs7yqChtPBS8Laf%2BbjVJenuF1Tt%2Bmn0TcMFEBMLeWBX71uxcuDkwEeFK6lodCcZgT8%2Fzdc9q&X-Amz-Signature=c40d1c9fa7097d2d4ae31db39372dfdeeac3042ce2e78d0a37a06c9ddd4b0ee3&X-Amz-SignedHeaders=host&x-id=GetObject)

